version: '2'

services:
  pebble-firmware:
    container_name: pebble-firmware
    #image: pebble-firmware:latest
    build: 
       context: .
       dockerfile: Dockerfile
    restart: on-failure
    environment:
      #- JRPC_FIRMWARE_BUILDKIT=$JRPC_FIRMWARE_BUILDKIT
      #- LC_ALL=C.UTF-8
      - LANG=C.UTF-8
      - ZEPHYR_SDK_INSTALL_DIR=/app/zephyr/zephyr-sdk-0.14.0
      - ZEPHYR_TOOLCHAIN_VARIANT=gnuarmemb
      - GNUARMEMB_TOOLCHAIN_PATH=/app/pebble-firmware/gnuarmemb
      # - CONFIG_CC310_BACKEND=true
      # - SOC_FAMILY_NRF=y
    volumes:
      - "/home/jeremi/Code/jrpc_beta/external/pebble-firmware/zephyr:/zephyr/"
      - "/home/jeremi/Code/jrpc_beta/external/pebble-firmware/tools:/tools/"
      - "/home/jeremi/Code/jrpc_beta/external/pebble-firmware/build:/build/"
      - "/home/jeremi/Code/jrpc_beta/external/pebble-firmware/external:/app/"
    #   - "/home/jeremi/Code/jrpc_beta/external/pebble-firmware/tools/Kconfig:/app/pebble-firmware-legacy/nrf/applications/asset_tracker/Kconfig"
    #   - "$JRPC/log/IoTeX_Mainnet_Log:/var/log"
    #   - "$JRPC/etc/IoTeX_Mainnet_Etc/config.yaml:/etc/iotex/config_override.yaml"
    #   - "$JRPC/etc/IoTeX_Mainnet_Etc/genesis.yaml:/etc/iotex/genesis.yaml"
    command: sleep infinity #$BUILD $FIRMWARE_PATH
    #west build -b thingy91_nrf9160ns /app/pebble-firmware-legacy/nrf/applications/asset_tracker/